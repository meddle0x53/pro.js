!function(a){window.Pro=a()}(function(){{var a={},b=Array.prototype,c=b.concat,d=b.every,e=b.filter,f=b.forEach,g=b.indexOf,h=b.join,i=b.lastIndexOf,j=b.map,k=b.pop,l=b.push,m=b.reduce,n=b.reduceRight,o=b.reverse,p=b.shift,q=b.slice,r=b.some,s=b.sort,t=b.splice,u=b.toLocaleString,v=b.toString;b.unshift}return a.States={init:1,ready:2,destroyed:3,error:4},a.Utils={},a.Utils.isFunction=function(a){return"function"==typeof a},a.Utils.isString=function(a){return"string"==typeof a},a.Utils.isArray=function(a){return"object"==typeof a&&"[object Array]"===Object.prototype.toString.call(a)},a.Utils.isProArray=function(b){return"object"==typeof b&&a.Utils.isArray(b._array)&&void 0!==b.length},a.Utils.isArrayObject=function(b){return a.Utils.isArray(b)||a.Utils.isProArray(b)},a.Utils.contains=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},a.Configuration={keyprops:!0,keypropList:["p"]},a.currentCaller=null,a.Queue=function(a,b){this.name=a||"proq",this.options=b||{},this._queue=[]},a.Queue.prototype={},a.Queue.prototype.length=function(){return this._queue.length/4},a.Queue.prototype.isEmpty=function(){return 0===this.length()},a.Queue.prototype.push=function(b,c,d){b&&a.Utils.isFunction(b)&&(d=c,c=b,b=null),this._queue.push(b,c,d,1)},a.Queue.prototype.pushOnce=function(b,c,d){b&&a.Utils.isFunction(b)&&(d=c,c=b,b=null);var e,f,g,h=this._queue,i=h.length;for(g=0;i>g;g+=4)if(e=h[g],f=h[g+1],e===b&&f===c)return h[g+2]=d,void(h[g+3]=h[g+3]+1);this.push(b,c,d)},a.Queue.prototype.go=function(a){var b,c,d,e,f,g=this._queue,h=this.options,i=g.length,j=h&&h.before,k=h&&h.after,l=h&&h.err,m=i,n=!0,o=1,p=m;for(i&&j&&j(this);n;){for(n=!1,m=p,b=0;m>b;b+=4)if(c=g[b],d=g[b+1],e=g[b+2],f=g[b+3],f===o)if(e&&e.length>0)if(l)try{d.apply(c,e)}catch(q){l(this,q)}else d.apply(c,e);else if(l)try{d.call(c)}catch(q){l(q)}else d.call(c);else f>o&&(n=!0,p=b+4);o+=1}i&&k&&k(this),g.length>i?(this._queue=g.slice(i),a||this.go()):this._queue.length=0},a.Queues=function(b,c){b||(b=["proq"]),this.queueNames=b,this.options=c||{},this._queues={};var d,e=this.queueNames.length;for(d=0;e>d;d++)this._queues[this.queueNames[d]]=new a.Queue(this.queueNames[d],this.options.queue)},a.Queues.prototype={},a.Queues.prototype.isEmpty=function(){var a,b,c,d=this._queues,e=this.queueNames,f=e.length;for(a=0;f>a;a++)if(b=e[a],c=d[b],!c.isEmpty())return!1;return!0},a.Queues.prototype.push=function(b,c,d,e){b&&!a.Utils.isString(b)&&(e=d,d=c,c=b,b=this.queueNames[0]),b||(b=this.queueNames[0]);var f=this._queues[b];f&&f.push(c,d,e)},a.Queues.prototype.pushOnce=function(b,c,d,e){b&&!a.Utils.isString(b)&&(e=d,d=c,c=b,b=this.queueNames[0]),b||(b=this.queueNames[0]);var f=this._queues[b];f&&f.pushOnce(c,d,e)},a.Queues.prototype.go=function(a){var b,c,d,e,f=0,g=this._queues,h=this.queueNames,i=this.queueNames.length;if(a)for(b=0;i>b;b++)h[b]===a&&(f=b);for(;i>f;)c=h[f],d=g[c],d.go(!0),-1===(e=this.probePrevIndex(f))?f+=1:f=e},a.Queues.prototype.probePrevIndex=function(a){var b,c,d,e=this._queues,f=this.queueNames;for(b=0;a>=b;b++)if(c=f[b],d=e[c],!d.isEmpty())return b;return-1},a.Flow=function(a,b){a||(a=["proq"]),this.queueNames=a,this.options=b||{},this.flowInstance=null},a.Flow.prototype={},a.Flow.prototype.start=function(){var b=this.flowInstance,c=this.options,d=c&&c.start,e=this.queueNames;b||(b=this.flowInstance=new a.Queues(e,c.flowInstance),d&&d(b))},a.Flow.prototype.end=function(){var a=this.flowInstance,b=this.options,c=b&&b.end;if(a)try{a.go()}finally{this.flowInstance=null,c&&c(a)}},a.Flow.prototype.run=function(a,b){var c=this.options,d=c.onError;if(!this.isRunning()){this.start(),b||(b=a,a=null);try{if(d)try{b.call(a)}catch(e){d(e)}else b.call(a)}finally{this.end()}}},a.Flow.prototype.isRunning=function(){return null!==this.flowInstance&&void 0!==this.flowInstance},a.Flow.prototype.push=function(a,b,c,d){if(!this.flowInstance)throw new Error("Not in running flow!");this.flowInstance.push(a,b,c,d)},a.Flow.prototype.pushOnce=function(a,b,c,d){if(!this.flowInstance)throw new Error("Not in running flow!");this.flowInstance.pushOnce(a,b,c,d)},a.flow=new a.Flow(["proq"]),a.Array=function(){this._array=0===arguments.length?[]:1===arguments.length&&a.Utils.isArray(arguments[0])?arguments[0]:q.call(arguments),this.indexListeners=[],this.lastIndexCaller=null,this.lengthListeners=[],this.lastLengthCaller=null;var b,c,d,e,f=this;b=function(){return f.addLengthCaller(),f._array.length},c=function(b){return f._array.length!==b?(e=f._array.length,f._array.length=b,a.flow.run(function(){f.willUpdate(a.Array.Operations.setLength,-1,e,b)}),b):void 0},Object.defineProperty(this,"length",{configurable:!1,enumerable:!0,get:b,set:c}),Object.defineProperty(this,"__pro__",{enumerable:!1,configurable:!1,writeble:!1,value:{}}),this.__pro__.state=a.States.init;try{for(d=0;d<this._array.length;d++)this.defineIndexProp(d);this.__pro__.state=a.States.ready}catch(g){throw this.__pro__.state=a.States.error,g}},a.Array.prototype=Object.create(b),a.Array.prototype.constructor=a.Array,a.Array.Operations={set:0,add:1,remove:2,setLength:3,reverse:4,sort:5,splice:6,isIndexOp:function(a){return a===this.set||a===this.reverse||a===this.sort}},a.Array.prototype.addLengthListener=function(a){this.lengthListeners.push(a)},a.Array.prototype.addLengthCaller=function(){var b=a.currentCaller;b&&this.lastLengthCaller!==b&&!a.Utils.contains(this.lengthListeners,b)&&(this.addLengthListener(b),this.lastLengthCaller=b)},a.Array.prototype.addIndexListener=function(a){this.indexListeners.push(a)},a.Array.prototype.addIndexCaller=function(){var b=a.currentCaller;b&&this.lastIndexCaller!==b&&!a.Utils.contains(this.indexListeners,b)&&(this.addIndexListener(b),this.lastIndexCaller=b)},a.Array.prototype.defineIndexProp=function(b){var c,d=this,e=d._array;Object.defineProperty(this,b,{enumerable:!0,configurable:!0,get:function(){return d.addIndexCaller(),e[b]},set:function(f){e[b]!==f&&(c=e[b],e[b]=f,a.flow.run(function(){d.willUpdate(a.Array.Operations.set,b,c,f)}))}})},a.Array.prototype.willUpdate=function(b,c,d,e){var f=a.Array.Operations.isIndexOp(b)?this.indexListeners:this.lengthListeners;this.willUpdateListeners(f,b,c,d,e)},a.Array.prototype.willUpdateSplice=function(b,c,d){var e,f=a.Array.Operations.splice;c&&d&&(0!==c.length||0!==d.length)&&(e=c.length===d.length?this.indexListeners:d.length&&c.length?this.lengthListeners.concat(this.indexListeners):this.lengthListeners,this.willUpdateListeners(e,f,b,c,d))},a.Array.prototype.willUpdateListeners=function(b,c,d,e,f){var g,h,i=b.length;for(g=0;i>g;g++)h=b[g],a.Utils.isFunction(h)?a.flow.pushOnce(h,[c,d,e,f]):a.flow.pushOnce(h,h.call,[c,d,e,f]),h.property&&h.property.willUpdate()},a.Array.prototype.concat=function(){return this.addIndexCaller(),this.addLengthCaller(),new a.Array(c.apply(this._array,arguments))},a.Array.prototype.every=function(){return this.addIndexCaller(),this.addLengthCaller(),d.apply(this._array,arguments)},a.Array.prototype.some=function(){return this.addIndexCaller(),this.addLengthCaller(),r.apply(this._array,arguments)},a.Array.prototype.filter=function(){return this.addIndexCaller(),this.addLengthCaller(),new a.Array(e.apply(this._array,arguments))},a.Array.prototype.forEach=function(){return this.addIndexCaller(),this.addLengthCaller(),f.apply(this._array,arguments)},a.Array.prototype.map=function(){return this.addIndexCaller(),this.addLengthCaller(),new a.Array(j.apply(this._array,arguments))},a.Array.prototype.reduce=function(){return this.addIndexCaller(),this.addLengthCaller(),m.apply(this._array,arguments)},a.Array.prototype.reduceRight=function(){return this.addIndexCaller(),this.addLengthCaller(),n.apply(this._array,arguments)},a.Array.prototype.indexOf=function(){return this.addIndexCaller(),this.addLengthCaller(),g.apply(this._array,arguments)},a.Array.prototype.lastIndexOf=function(){return this.addIndexCaller(),this.addLengthCaller(),i.apply(this._array,arguments)},a.Array.prototype.join=function(){return this.addIndexCaller(),this.addLengthCaller(),h.apply(this._array,arguments)},a.Array.prototype.toLocaleString=function(){return this.addIndexCaller(),this.addLengthCaller(),u.apply(this._array,arguments)},a.Array.prototype.toString=function(){return this.addIndexCaller(),this.addLengthCaller(),v.apply(this._array,arguments)},a.Array.prototype.valueOf=function(){return this.toArray()},a.Array.prototype.slice=function(){return this.addIndexCaller(),this.addLengthCaller(),new a.Array(q.apply(this._array,arguments))},a.Array.prototype.reverse=function(){if(0!==this._array.length){var b=o.apply(this._array,arguments),c=this;return a.flow.run(function(){c.willUpdate(a.Array.Operations.reverse,-1,null,null)}),b}},a.Array.prototype.sort=function(){if(0!==this._array.length){var b=s.apply(this._array,arguments),c=this;return a.flow.run(function(){c.willUpdate(a.Array.Operations.sort,-1,null,null)}),b}},a.Array.prototype.splice=function(b,c){var d,e=this._array.length,f=t.apply(this._array,arguments),g=this._array.length,h=this,i=q.call(arguments,2);if(b=~b?b:g-b,c=(null==c?g-b:c)||0,i.length>c)for(d=i.length-c;d--;)this.defineIndexProp(e++);else if(c>i.length)for(d=c-i.length;d--;)delete this[--e];return a.flow.run(function(){h.willUpdateSplice(b,f,i)}),new a.Array(f)},a.Array.prototype.pop=function(){if(0!==this._array.length){var b=k.apply(this._array,arguments),c=this,d=this._array.length;return delete this[d],a.flow.run(function(){c.willUpdate(a.Array.Operations.remove,c._array.length,b,null)}),b}},a.Array.prototype.push=function(){var b,c,d=arguments,e=arguments.length,f=this;for(b=0;e>b;b++)c=this._array.length,l.call(this._array,arguments[b]),this.defineIndexProp(c);return a.flow.run(function(){f.willUpdate(a.Array.Operations.add,f._array.length-1,null,d)}),this._array.length},a.Array.prototype.shift=function(){if(0!==this._array.length){var b=p.apply(this._array,arguments),c=this,d=this._array.length;return delete this[d],a.flow.run(function(){c.willUpdate(a.Array.Operations.remove,0,b,null)}),b}},a.Array.prototype.unshift=function(){for(var b,c=arguments,d=arguments.length,e=this._array,f=this,b=0;d>b;b++)e.splice(b,0,arguments[b]),this.defineIndexProp(e.length-1);return a.flow.run(function(){f.willUpdate(a.Array.Operations.add,0,null,c)}),e.length},a.Array.prototype.toArray=function(){return this._array},a.Array.prototype.toJSON=function(){return JSON1.stringify(this._array)},a.Property=function(b,c,d,e){this.proObject=b,this.property=c,this.proObject.__pro__||(this.proObject.__pro__={}),this.proObject.__pro__.properties=this.proObject.__pro__.properties||{},this.proObject.__pro__.properties[c]=this,this.get=d||a.Property.DEFAULT_GETTER(this),this.set=e||a.Property.DEFAULT_SETTER(this),this.oldVal=null,this.val=b[c],this.listeners=[],this.state=a.States.init,this.g=this.get,this.s=this.set,this.init()},a.Property.Types={simple:0,auto:1,object:2,array:3},a.Property.DEFAULT_GETTER=function(a){return function(){return a.addCaller(),a.val}},a.Property.DEFAULT_SETTER=function(b){return function(c){b.val!==c&&(b.oldVal=b.val,b.val=c,a.flow.run(function(){b.willUpdate()}))}},a.Property.defineProp=function(a,b,c,d){Object.defineProperty(a,b,{get:c,set:d,enumerable:!0,configurable:!0})},a.Property.prototype.type=function(){return a.Property.Types.simple},a.Property.prototype.init=function(){this.state===a.States.init&&(a.Property.defineProp(this.proObject,this.property,this.get,this.set),this.afterInit())},a.Property.prototype.afterInit=function(){this.state=a.States.ready},a.Property.prototype.addCaller=function(){var b=a.currentCaller;b&&b.property.property!=this.property&&this.addListener(b)},a.Property.prototype.destroy=function(){this.state!==a.States.destroyed&&(delete this.proObject.__pro__.properties[this.property],this.listeners=void 0,this.oldVal=void 0,Object.defineProperty(this.proObject,this.property,{value:this.val,enumerable:!0,configurable:!0}),this.get=this.set=this.property=this.proObject=void 0,this.g=this.s=void 0,this.val=void 0,this.state=a.States.destroyed)},a.Property.prototype.addListener=function(a){this.listeners.push(a)},a.Property.prototype.removeListener=function(a){var b;for(b=0;b<this.listeners.length;b++)if(this.listeners[b]==a){this.listeners.splice(b,1);break}},a.Property.prototype.notifyAll=function(){var a;for(a=0;a<this.listeners.length;a++)this.listeners[a].call(this.proObject)},a.Property.prototype.willUpdate=function(){var b,c,d=this.listeners,e=d.length;for(b=0;e>b;b++)c=d[b],a.Utils.isFunction(c)?a.flow.pushOnce(c):a.flow.pushOnce(c,c.call),c.property&&c.property.willUpdate()},a.AutoProperty=function(b,c){this.func=b[c];var d=this,e=function(){d.addCaller();var e=a.currentCaller,f=a.Property.DEFAULT_GETTER(d),g=a.Property.DEFAULT_SETTER(d);return a.currentCaller={property:d,call:function(){b[c]=d.func.call(b)}},d.val=d.func.apply(d.proObject,arguments),a.currentCaller=e,a.Property.defineProp(d.proObject,d.property,f,g),d.state=a.States.ready,d.val};a.Property.call(this,b,c,e,function(){})},a.AutoProperty.prototype=Object.create(a.Property.prototype),a.AutoProperty.prototype.constructor=a.AutoProperty,a.AutoProperty.prototype.type=function(){return a.Property.Types.auto},a.AutoProperty.prototype.afterInit=function(){},a.ObjectProperty=function(b,c){var d,e=this;d=function(){e.addCaller(),e.val.__pro__||a.prob(e.val);var b=a.Property.DEFAULT_GETTER(e),c=function(b){if(e.val!=b){if(e.oldVal=e.val,e.val=b,e.oldVal){e.val.__pro__||a.prob(e.val);var c,d,f,g,h,i,j,k,l,m,n,o=e.oldVal.__pro__.properties,p=e.val.__pro__.properties,q=[];for(c in o)if(o.hasOwnProperty(c)){for(f=p[c],h=f.listeners,d=o[c],g=d.listeners,k=g.length,i=0;k>i;i++){for(m=!0,j=0;l>j;j++)g[i]==h[j]&&(m=!1);m&&(f.addListener(g[i]),q.push(i))}for(n=q.length,i=0;n>i;i++)g.splice[(q[i],1)];q=[]}}a.flow.run(function(){e.willUpdate()})}};return a.Property.defineProp(e.proObject,e.property,b,c),e.state=a.States.ready,e.val},a.Property.call(this,b,c,d,function(){})},a.ObjectProperty.prototype=Object.create(a.Property.prototype),a.ObjectProperty.prototype.constructor=a.ObjectProperty,a.ObjectProperty.prototype.type=function(){return a.Property.Types.object},a.ObjectProperty.prototype.afterInit=function(){},a.ArrayProperty=function(b,c){var d,e=this;d=function(){e.addCaller(),a.Utils.isProArray(e.val)||(e.val=new a.Array(e.val));var b=a.Property.DEFAULT_GETTER(e),c=function(b){if(e.val!=b&&e.val.valueOf()!=b){if(e.oldVal=e.val,e.val=b,a.Utils.isProArray(e.val)||(e.val=new a.Array(e.val)),e.oldVal){var c,d,f,g=[],h=e.oldVal.indexListeners,i=h.length,j=e.val.indexListeners,k=e.oldVal.lengthListeners,l=k.length,m=e.val.lengthListeners;for(c=0;i>c;c++)d=h[c],d.property&&d.property.proObject===e.proObject&&(j.push(d),g.push(c));for(f=g.length,c=0;f>c;c++)h.splice[(g[c],1)];for(g=[],c=0;l>c;c++)d=k[c],d.property&&d.property.proObject===e.proObject&&(m.push(d),g.push(c));for(f=g.length,c=0;f>c;c++)k.splice[(g[c],1)];g=[]}a.flow.run(function(){e.willUpdate()})}};return a.Property.defineProp(e.proObject,e.property,b,c),e.state=a.States.ready,e.val},a.Property.call(this,b,c,d,function(){})},a.ArrayProperty.prototype=Object.create(a.Property.prototype),a.ArrayProperty.prototype.constructor=a.ArrayProperty,a.ArrayProperty.prototype.type=function(){return a.Property.Types.array},a.ArrayProperty.prototype.afterInit=function(){},a.prob=function(b){if(!b)throw Error("Pro objects should not be empty or null!");try{Object.defineProperty(b,"__pro__",{enumerable:!1,configurable:!1,writeble:!1,value:{}}),b.__pro__.state=a.States.init;var c,d=a.Configuration,e=d.keyprops,f=d.keypropList;isF=a.Utils.isFunction,isA=a.Utils.isArrayObject;for(c in b){if(e&&-1!==f.indexOf(c))throw Error("The property name "+c+" is a key word for pro objects! Objects passed to Pro.prob can not contain properties named as keyword properties.");!b.hasOwnProperty(c)||isF(b[c])||isA(b[c])?b.hasOwnProperty(c)&&isF(b[c])?new a.AutoProperty(b,c):b.hasOwnProperty(c)&&isA(b[c])&&new a.ArrayProperty(b,c):new a.Property(b,c)}d.keyprops&&-1!==f.indexOf("p")&&Object.defineProperty(b,"p",{enumerable:!1,configurable:!1,writeble:!1,value:function(a){return this.__pro__.properties[a]}}),b.__pro__.state=a.States.ready}catch(g){throw b.__pro__.state=a.States.error,g}return b},a});